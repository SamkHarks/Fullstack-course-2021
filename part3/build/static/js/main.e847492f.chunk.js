(this.webpackJsonpphonebook=this.webpackJsonpphonebook||[]).push([[0],{38:function(e,n,t){},39:function(e,n,t){"use strict";t.r(n);var r=t(14),c=t.n(r),o=t(3),a=t(2),u=t(4),i=t.n(u),s="api/persons",d={getAll:function(){return i.a.get(s).then((function(e){return e.data}))},create:function(e){return i.a.post(s,e).then((function(e){return e.data}))},deletePerson:function(e){return i.a.delete("".concat(s,"/").concat(e)).then((function(e){return e.data}))},update:function(e,n){return i.a.put("".concat(s,"/").concat(e),n).then((function(e){return e.data}))}},l=t(0),f=function(e){var n=e.message;return null===n?null:n.includes("Information")||n.includes("failed")?Object(l.jsx)("div",{className:"error",children:n}):Object(l.jsx)("div",{className:"message",children:n})},j=function(e){var n=e.name,t=e.handler;return Object(l.jsxs)("div",{children:["filter shown with ",Object(l.jsx)("input",{value:n,onChange:t})]})},b=function(e){return Object(l.jsxs)("form",{onSubmit:e.addPerson,children:[Object(l.jsxs)("div",{children:["name: ",Object(l.jsx)("input",{value:e.newName,onChange:e.handleNameChange})]}),Object(l.jsxs)("div",{children:["number: ",Object(l.jsx)("input",{value:e.newNumber,onChange:e.handleNumberChange})]}),Object(l.jsx)("div",{children:Object(l.jsx)("button",{type:"submit",children:"add"})})]})},h=function(e){var n=e.person,t=e.handleDelete;return Object(l.jsx)("tr",{children:Object(l.jsxs)("td",{children:[n.name," ",n.number,Object(l.jsx)("button",{onClick:t,children:"delete"})]})})},m=function(e){var n=e.personsToShow,t=e.persons,r=e.setPersons,c=e.setMessage;return Object(l.jsx)("table",{children:Object(l.jsx)("tbody",{children:n.map((function(e){return Object(l.jsx)(h,{person:e,handleDelete:function(){return function(e){var n=t.find((function(n){return n.id===e}));window.confirm("Delete ".concat(n.name," ?"))&&d.deletePerson(e).then((function(n){return r(t.filter((function(n){return n.id!==e})))})).catch((function(o){c("Information of ".concat(n.name," has already been removed from server")),setTimeout((function(){return c(null)}),5e3),r(t.filter((function(n){return n.id!==e})))}))}(e.id)}},e.id)}))})})},O=function(){var e=Object(a.useState)([]),n=Object(o.a)(e,2),t=n[0],r=n[1],c=Object(a.useState)(""),u=Object(o.a)(c,2),i=u[0],s=u[1],h=Object(a.useState)(""),O=Object(o.a)(h,2),p=O[0],v=O[1],x=Object(a.useState)(""),g=Object(o.a)(x,2),w=g[0],N=g[1],C=Object(a.useState)(null),S=Object(o.a)(C,2),k=S[0],P=S[1];Object(a.useEffect)((function(){d.getAll().then((function(e){r(e)}))}),[]);var T=""===w?t:t.filter((function(e){return e.name.toLowerCase().includes(w.toLowerCase())}));return Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Phonebook"}),Object(l.jsx)(f,{message:k}),Object(l.jsx)(j,{name:w,handler:function(e){N(e.target.value)}}),Object(l.jsx)("h3",{children:"Add a new"}),Object(l.jsx)(b,{addPerson:function(e){e.preventDefault();var n={name:i,number:p};if(t.some((function(e){return e.name===n.name}))){if(window.confirm("".concat(n.name," is already added to phonebook, replace the old number with new one?"))){var c=t.find((function(e){return e.name===n.name})).id;d.update(c,n).then((function(e){P("Number changed to ".concat(e.number)),setTimeout((function(){return P(null)}),5e3),r(t.map((function(n){return n.id!==c?n:e}))),s(""),v("")})).catch((function(e){console.log(e),e.response?P("".concat(e.response.data.error)):(P("Information of ".concat(n.name," has already been removed from server")),r(t.filter((function(e){return e.id!==c})))),setTimeout((function(){return P(null)}),8e3)}))}}else d.create(n).then((function(e){r(t.concat(e)),s(""),v(""),P("Added ".concat(e.name)),setTimeout((function(){return P(null)}),5e3)})).catch((function(e){console.log(e.response.data),P("".concat(e.response.data.error)),setTimeout((function(){return P(null)}),8e3)}))},newName:i,handleNameChange:function(e){s(e.target.value)},newNumber:p,handleNumberChange:function(e){v(e.target.value)}}),Object(l.jsx)("h3",{children:"Numbers"}),Object(l.jsx)(m,{personsToShow:T,persons:t,setPersons:r,setMessage:P})]})};t(38);c.a.render(Object(l.jsx)(O,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.e847492f.chunk.js.map